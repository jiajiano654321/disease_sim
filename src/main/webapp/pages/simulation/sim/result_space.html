<% var headContent = { include("/pages/template/head.html"){} %>
<script type="text/javascript"
	src="static/component/echarts/echarts.min.js"></script>
<script type="text/javascript"
	src="static/component/echarts/china.js"></script>
<% }; var bodyContent = { %>
<div id="main" style="width: 100%; height: 800px;"></div>
<script type="text/javascript">
var myChart = echarts.init(document.getElementById('main'));
var option = {
	xAxis : {
		type:'category',
		splitNumber:10,
        show: false
        
	},
	yAxis : {
		type:'category',
		splitNumber:10,
		show: false
	} ,
    visualMap: {
        type: 'piecewise',
        pieces: [
            {min: 5},
            {min: 4, max: 5},
            {min: 3, max: 4},
            {min: 2, max: 3},
            {min: 1, max: 2},
            {max: 1}
        ]
    },
    geo
	series : [ {
		type : 'heatmap',
		data : [[0,0,5],[1,1,1],[1,2,5],[3,3,0],[4,4,2],[5,5,4],[6,6,0],[5,7,0],[9,8,3],[10,9,3],[0,10,1]],
 //   itemStyle: {
  //      emphasis: {
  //          shadowBlur: 10,
  //          shadowColor: 'rgba(0, 0, 0, 0.5)'
  //      }
   // }
	}]
};
var url = "sim/result/getSpaceNums";
$.ajax({
	type : "POST",
	url : url,
	dataType : "json",
	success : function(data) {
		cuts = data.cuts;
		var pieces = [];
		for(i = 0;i <= cuts.length;i++){
			var ele;
			if(i == 0){
				ele = {min : 0,max : cuts[i]};
			}else if( i == cuts.length){
				ele = {min : cuts[i-1]};
			}else {
				ele = {min : cuts[i-1],max : cuts[i]};
			}
			pieces.push(ele);
		}
		option.visualMap.pieces = pieces;
		var eles = data.elements;
		var _setTimeout=setTimeout;
		/*
		window.setTimeout=function(callback,time,params){
		   var param=Array.prototype.slice.call(arguments,2);
		   var _callback=function(){
		     callback.apply(null,param);
		   }
		   _setTimeout(_callback,time);
		}*/
		var i = 0;
		var refreshData = function(){
				nums = eles[i];
				option.series[0].data = nums;
				myChart.setOption(option);
				i++;
				if(i == eles.length){
					clearInterval(inter);
				}
		}
		var inter = setInterval(refreshData,1000);

	},
	error : function(msg) {
		alert("error");
	}
});
</script>
<%}; %> <%
layout("/pages/template/_layout.html",{head:headContent,body:bodyContent}){
%> <%} %>
